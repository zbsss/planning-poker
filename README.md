## Getting Started

- `npm run dev` - starts the Next.js app
- `npm run dev:all` - starts Next.js app in parallel with `graphql-codegen --watch`

> When running `npm run dev:all` all changes made to the Nexus definitions inside of `/graphql/types/**.ts` will trigger an automatic update of the `generated/schema.graphql` which in turn will trigger an update of `/generated/graphql.tsx`.

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

Open [Apollo Studio](https://studio.apollographql.com/sandbox/explorer) to explore the GraphQL API.

## Files

- `/graphql/**/**.graphql` - client side query/mutation definitions.

- `/generated/graphql.tsx` - client side code (React hooks, types) generated by `graphql-codegen`

- `/graphql/types/**.ts` - stores `Nexus` definitions of the GraphQL API.

- `/generated/nexus-typegen.ts` - internal Nexus types

- `/generated/schema.graphql` - whole GraphQL API definition generated automatically by `Nexus` based on `/graphql/schema.ts`

## Prisma

`npx prisma db seed`

`prisma generate` - Generate artifacts (e.g. Prisma Client)

`prisma studio` - Browse your data

`prisma migrate dev` - Create migrations from your Prisma schema, apply them to the database, generate artifacts (e.g. Prisma Client)

`prisma db pull` - Pull the schema from an existing database, updating the Prisma schema

`prisma db push` - Push the Prisma schema state to the database

---

## TODOs

### Revealing cards

- protect `chosenCard` information before `revealAt` has elapsed
- when everyone is in ready status display the "Reveal cards" button
- when pressed send a mutation that changes `revealAt` of the table
- each player has a subscription waiting for changes of `revealAt`
- when `revealAt` is withing 5s in the future display a countdown (disable users from removing their vote, but they can still change it)
- when the timer runs out block users from changing their votes and make a query to download votes of all the other players

### Other

- what if a new player joins the room?
  - we need to send all of user's data through subscriptions (this way if new user joins they will be automatically displayed on the table)
- update cache after mutation
- better error handling in graphql API
- better UI
- inviting players via a link that has a expiry date
